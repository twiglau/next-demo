# `gcTime: Infinity,staleTime: Infinity`, 参数是什么意思？

- 这两个参数是 TanStack Query (React Query) 中非常核心的概念，用于控制数据的缓存策略和新鲜度。

- 特别是在设置了 Infinity（无穷大）时，它们的行为如下：

1. staleTime: Infinity (新鲜时间)

staleTime 决定了数据在多长时间内被认为是**“新鲜” (Fresh)** 的。

- 默认行为：默认值为 0。这意味着数据一旦拿到手就立即变“旧” (Stale)。下次组件挂载或窗口重新聚焦时，React Query 会立即发起后台静默刷新。
- 设置 Infinity 的意思：数据永远不会变旧。
  - 只要数据在缓存里，不管你切走页面再切回来，还是组件重新销毁又挂载，React Query 都不会重新发送网络请求。
  - 它会一直认为缓存中的数据是最新的。
- 适用场景：适用于那些在用户单次访问期间几乎不会改变的数据，例如：国家列表、用户基础设置、静态配置信息。

2. gcTime: Infinity (垃圾回收时间)
   gcTime (在 v4 版本以前叫 cacheTime) 决定了不被使用的数据在缓存中保留多久。

- 什么时候开始计时？ 当一个查询不再被任何组件使用（组件卸载了，或者没有页面在监听这个 Key）时，数据会进入“非活跃” (Inactive) 状态，此时计时器开始。
- 默认行为：默认值为 5分钟 (300,000ms)。如果 5 分钟内没有再次使用这个数据，它就会被从内存中清除（垃圾回收）。
- 设置 Infinity 的意思：数据永远不会被垃圾回收。
  - 即使没有任何地方在使用这个数据，它也会一直保存在内存中，直到用户直接关闭浏览器标签页。
- 注意：gcTime 必须大于或等于 staleTime 才有意义。

## 总结：当两者都设为 Infinity 时

这种组合常见于**“一次加载，全程使用”**的策略：

1. 首屏加载：第一次请求数据。
2. 永不刷新：因为 staleTime: Infinity，React Query 以后再也不会自动去后台更新它。
3. 永不丢弃：因为 gcTime: Infinity，即使你跳到了其他完全无关的页面（导致原本引用该数据的组件被彻底销毁），这个数据依然在内存里占着位子。

> [!TIP] 小心过度使用：如果你的应用有很多大数据量的查询，全都设为 Infinity 可能会导致浏览器内存占用过高。通常建议只对那些真正的静态常量数据使用此配置。
